# .github/workflows/inspect-key.yml

name: Inspect PGP Public Key 🔑

on:
  # mainブランチへのプッシュ時（変更なし）
  push:
    branches: [ main ]
  # 手動実行の定義を強化
  workflow_dispatch:
    # ここで手動実行時の入力フォームを定義します
    inputs:
      key_path:
        description: 'リポジトリ内のPGP公開鍵ファイルのパス'
        required: true
        default: 'public-key.asc'
        type: string

jobs:
  inspect:
    runs-on: ubuntu-latest
    steps:
      - name: Check out repository
        uses: actions/checkout@v4

      - name: Inspect PGP Key File
        run: |
          # 手動実行時に入力された値を変数にセットします
          KEY_FILE="${{ inputs.key_path }}"

          if [ ! -f "$KEY_FILE" ]; then
            echo "Error: Key file not found at '$KEY_FILE'"
            exit 1
          fi

          echo "✅ Inspecting key file: $KEY_FILE"
          echo "------------------------------------"
          gpg --show-keys "$KEY_FILE"
