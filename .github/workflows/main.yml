# .github/workflows/inspect-key.yml

name: Inspect PGP Public Key ğŸ”‘

on:
  # mainãƒ–ãƒ©ãƒ³ãƒã¸ã®ãƒ—ãƒƒã‚·ãƒ¥æ™‚ï¼ˆå¤‰æ›´ãªã—ï¼‰
  push:
    branches: [ main ]
  # æ‰‹å‹•å®Ÿè¡Œã®å®šç¾©ã‚’å¼·åŒ–
  workflow_dispatch:
    # ã“ã“ã§æ‰‹å‹•å®Ÿè¡Œæ™‚ã®å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ã‚’å®šç¾©ã—ã¾ã™
    inputs:
      key_path:
        description: 'ãƒªãƒã‚¸ãƒˆãƒªå†…ã®PGPå…¬é–‹éµãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹'
        required: true
        default: 'public-key.asc'
        type: string

jobs:
  inspect:
    runs-on: ubuntu-latest
    steps:
      - name: Check out repository
        uses: actions/checkout@v4

      - name: Inspect PGP Key File
        run: |
          # æ‰‹å‹•å®Ÿè¡Œæ™‚ã«å…¥åŠ›ã•ã‚ŒãŸå€¤ã‚’å¤‰æ•°ã«ã‚»ãƒƒãƒˆã—ã¾ã™
          KEY_FILE="${{ inputs.key_path }}"

          if [ ! -f "$KEY_FILE" ]; then
            echo "Error: Key file not found at '$KEY_FILE'"
            exit 1
          fi

          echo "âœ… Inspecting key file: $KEY_FILE"
          echo "------------------------------------"
          gpg --show-keys "$KEY_FILE"
